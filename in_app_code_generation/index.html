<!DOCTYPE html>
<html lang="en">
<head>
    <!-- Meta, title, CSS, favicons, etc. -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="Wikismith">

    <title>
      In App Code Generation
    </title>

    <!-- bower:css -->
    <link rel="stylesheet" href="/bs3/bower/css/bootstrap.css">
    <!-- endinject -->

    <!-- inject:css -->
    <link rel="stylesheet" href="/bs3/css/blog.css">
    <link rel="stylesheet" href="/bs3/css/docs.min.css">
    <link rel="stylesheet" href="/bs3/css/railscasts.css">
    <!-- endinject -->

    <!--[if lt IE 9]><script src="../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../assets/js/ie10-viewport-bug-workaround.js"></script>
    <script src="../assets/js/ie-emulation-modes-warning.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" href="/apple-touch-icon-precomposed.png">
    <link rel="icon" href="/favicon.ico">


</head>
<body>
<a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

<!-- Docs master nav -->
<header class="navbar navbar-static-top bs-docs-nav" id="top" role="banner">
    <div class="container">
        <div class="navbar-header">
            <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".bs-navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <a href="../../../" class="navbar-brand">
              <img src="http://www.gravatar.com/avatar/91f491389b01231140190aef863408c9.png">
              &nbsp;
              jrhicks.github.io
            </a>
        </div>
        <nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
            <!--
            <ul class="nav navbar-nav">
                <li>
                    <a href="/interests.html">Interest</a>
                </li>
                <li>
                    <a href="/projects">Projects</a>
                </li>
                <li>
                    <a href="/about">Speaking</a>
                </li>
            </ul>
            <ul class="nav navbar-nav navbar-right">
                <li><a href="http://blog.getbootstrap.com" onclick="ga('send', 'event', 'Navbar', 'Community links', 'Blog');">About</a></li>
            </ul>
            -->
        </nav>
    </div>
</header>



<!-- Docs page layout -->
<div class="bs-docs-header" id="content">
    <div class="container">
        <h1>In App Code Generation</h1>
        <p></p>
    </div>
</div>

<div class="container bs-docs-container">

<div class="row">
<div class="col-md-9" role="main">


<div class="alert alert-success" role="alert">Want to help improve this article? <a href="https://github.com/jrhicks/jrhicks.github.source/edit/master/pages/in_app_code_generation/index.md">Edit it</a></div>

<p>##Introduction</p>
<p>Have you ever used the --save option when you npm-install a package.  Of course you do!  Because regardless your stance on code generation, a modest amount of assistance rocks!  I tend to think of application writing as a balance between code generation (but not too much) and refactoring (but not too much).</p>
<p><img src="./the_fine_line.png" /></p>
<p>I wish there was a golden rule to knowing the perfect amount of code generation and refactoring.  If you find one, please share.  But for now, lets say some code generation is good, its up to you to determine how much.  Now that were passed that; what is the best way to generate code!  </p>
<p>##An Index Pattern</p>
<p>Lets say I want to maintain an index of FooBars.  So that every time I create a FooBar it gets added to this index.js:</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> SmartFooBar <span class="hljs-keyword">from</span> <span class="hljs-string">'./SmartFoobar'</span>;
<span class="hljs-keyword">import</span> SillyFooBar <span class="hljs-keyword">from</span> <span class="hljs-string">'./SillyFoobar'</span>;
<span class="hljs-keyword">import</span> AwesomeFooBar <span class="hljs-keyword">from</span> <span class="hljs-string">'./AwesomeFoobar'</span>;

<span class="hljs-keyword">let</span> foobars = {
  smart: SmartFooBar,
  silly: SillyFooBar,
  awesome: AwesomeFooBar
}

<span class="hljs-built_in">module</span>.exports = foobars;
</code></pre>
<p>For me personally, keeping indexes has become a convenient pattern.  I only have to import the foobars index to get access to any foobar in my app.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">import</span> foobars <span class="hljs-keyword">from</span> <span class="hljs-string">'../Foobars/index.js'</span>;

foobars.silly.go()
</code></pre>
<!-- h2 --><h2 id="md-in-app-generator">in-app-generator</h2><p>Why would you want an in-app-generator?  Many reasons!  </p>
<p>First.  Avoid creating a product. Most people that I know that use code generation don&#39;t like developing their generators in a separate package and using NPM link.  This encourages them to &quot;productize&quot; their code generator and get distracted.  I feel that you should be encouraged to write throw-away generators that are as custom as your app itself.  No wonder javascript has a million &quot;frameworks&quot;.  Every app specific generator is published.  They have little relevance to your project unless your just getting started and they made every exact choice you made.</p>
<p>Second.  In app generators can share your application&#39;s code.  This is a subtle, but important point.  A generator should be able to reflect on the shape and structure of your data and application to create meaningful scaffolds.  To do this reasonably, your app becomes part of the generator, the line is blurred - and thus you have an in-app-generator.</p>
<p>Last.  Thats the way Rails does it.  I&#39;ve used Rails since 2005 and I&#39;ve grown accustomed to maintaining custom generators for each project that make sense for the specific project.  I wanted it, so I made it.</p>
<!-- h2 --><h2 id="md-why-yet-another-yo-slush">Why Yet Another Yo, Slush</h2><p>Being in-app was important, and being in-app means that the CLI needed to be able to require ES6 (my app).  Not knowing how to make Yo or Slush do this, I figured it shouldn&#39;t be too hard to create my own generator.  What I discovered was that it wasn&#39;t hard.  And I learned a lot of cool things about Babel on the way.</p>
<!-- h4 --><h4 id="md-using-babel-to-run-es6-without-build">Using Babel To Run ES6 Without Build</h4><p>Luckily the in-app-generator CLI could use babel core to translate on-the-fly.  It really just took two lines of code.  Below is basically how in-app-generator (and babel-node) run ES6 on node.  The magic is in register.  Register changes how subsequent calls to require work.  After register, subsequent calls to require will transpile to ES5 on-the-fly.</p>
<pre><code class="lang-javascript"><span class="hljs-keyword">var</span> babel = <span class="hljs-keyword">require</span>(<span class="hljs-string">'babel-core'</span>);
babel.<span class="hljs-keyword">register</span>(<span class="hljs-comment">{stage: 0}</span>)
</code></pre>
<p>After this, all subsequent require&#39;s translate ES6/7 to ES5 on-the-fly.</p>
<!-- h2 --><h2 id="md-using-babel-for-code-injection">Using Babel For Code Injection</h2><p>Babel</p>
<ul>
<li>Code GenI wanted to add an API to the in-app-generator to make things like maintaining an index.js (like above) ... really easy :).</li>
</ul>
<p>Fun code generation begins and ends with babel.</p>
<p><a href="https://github.com/babel/babel/blob/7905f482804017888dba820f23cec1d5656b39ff/src/babel/transformation/file/index.js">https://github.com/babel/babel/blob/7905f482804017888dba820f23cec1d5656b39ff/src/babel/transformation/file/index.js</a></p>
<!-- end -->
<hr>

<a href="https://twitter.com/share" class="twitter-share-button" data-via="jrhicks">Tweet</a>

<a href="https://twitter.com/jrhicks">Follow Jeffrey Hicks on Twitter</a></a>
<hr>
<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'jrhicksgithubio';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>


</div>

<div class="col-md-3">
    <div class="bs-docs-sidebar hidden-print hidden-xs hidden-sm" role="complementary">

        <ul class="nav bs-docs-sidenav">
            
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
          <li style="margin-left: 0.5em;"><a href="#md-in-app-generator">in-app-generator</a></li>
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
          <li style="margin-left: 0.5em;"><a href="#md-why-yet-another-yo-slush">Why Yet Another Yo, Slush</a></li>
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
          <li style="margin-left: 0.5em;"><a href="#md-using-babel-for-code-injection">Using Babel For Code Injection</a></li>
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
          
            
            
        </ul>


    </div>
</div>
</div>
</div>

<!-- Footer
================================================== -->
<footer class="bs-docs-footer" role="contentinfo">
    <div class="container">
        <p>Generated with <a href="http://wikismith.com">Wikismith</a> - <a href="http://getbootstrap.com">Bootstrap 3</a> Theme
    </div>
</footer>

<!-- bower:js -->
<script src="/bs3/bower/js/jquery.js"></script>
<script src="/bs3/bower/js/bootstrap.js"></script>
<!-- endinject -->

<!-- inject:js -->
<script src="/bs3/js/docs.min.js"></script>
<!-- endinject -->


<!-- TWITTER Put this just before the closing body tag -->
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
</body>
</html>
